---
title: "Meta-analysis of the Interoceptive Accuracy Scale"
subtitle: "Study 2"
editor: source
editor_options: 
  chunk_output_type: console
format:
  html:
    code-fold: true
    self-contained: true
    toc: true
    fig-dpi: 300
    fig-width: 11.33
execute: 
  cache: true
---

```{r}
#| message: false
#| warning: false

library(tidyverse)
library(easystats)
library(patchwork)
library(lavaan)
library(ggraph)
library(tidySEM)
library(EGAnet)
```

## Measures used

```{r}
library(gt)

# APA style ####
gt_apastyle <- function(gt_table, font.size=12) {
  gt_table  |> 
    gt::opt_table_lines(extent = "none") %>%
    gt::tab_options(
      heading.border.bottom.width = 2,
      heading.border.bottom.color = "black",
      heading.border.bottom.style = "solid",
      table.border.top.color = "black",
      table.border.top.style = "solid",
      table.border.top.width = 2,  
      table_body.hlines.color = "white",
      table_body.border.top.color = "black",
      table_body.border.top.style = "solid",
      table_body.border.top.width = 2,
      heading.title.font.size = font.size,
      table.font.size = font.size,
      heading.subtitle.font.size = font.size,
      table_body.border.bottom.color = "black",
      table_body.border.bottom.width = 2,
      table_body.border.bottom.style = "solid",
      column_labels.border.bottom.color = "black",
      column_labels.border.bottom.style = "solid",
      column_labels.border.bottom.width = 1,
      latex.use_longtable = FALSE
    ) |> 
      gt::opt_table_font(font = "times")
}


table <- data.frame(
  Questionnaire = c("Interoceptive Related", "MAIA-2", "BPQ", "TAS-20", "BVAQ",
                    "Mood", "BDI-II", "PHQ-4", "STAI-T", "GAD-2",
                    "Personality", "NEO-FFI", "Mini IPIP6", "BFI", "PID-5-SF",
                    "Psychopathology", "SPQ-BRU", "MSI-BPD", "ASQ - Short",
                    "Beliefs and Misbeliefs", "GCB", "PI-18", "LIE scale"),
  Number_of_Dimensions = c('', 8, 2, 3, 2, 
                           '', 1, 2, 1, 1, 
                           '', 1, 6, 5, 5, 
                           '', 4, 1, 5, 
                           '', 5, 1, 4),
  Assessment = c('', "Interoception", "Body awareness and autonomic reactivity", "Alexithymia", "Alexithymia",
                 '',"Severity of depressive symptoms", "Anxiety and depressive symptoms", "Trait anxiety", "General Anxiety",
                 '', "Neuroticism", "Personality", "Personality", "Dysfunctional personality traits",
                 '', "Schizotypy", "Borderline personality disorder", "Autistic Traits",
                 '', "Conspiracy beliefs", "Beliefs about the world", "Lying tendencies"),
  Number_of_Items = c('',37, 49, 20, 40, 
                      '',21, 4, 20, 2, 
                      '',12, 24, 44, 25, 
                      '',32, 10, 28, 
                      '',15, 99, 16),
  Scoring = c('',"6-point Likert scale", "5-point Likert scale", "5-point Likert scale", "5-point Likert scale", 
              '',"0-to-3-point values", "5-point Likert scale", "4-point Likert scale", "4-point Likert scale", 
              '',"5-point Likert scale", "Analogue scales", "5-point Likert scale", "4-point Likert scale", 
              '',"5-point Likert scale", "Analogue scales", "4-point Likert scale", 
              '',"5-point Likert scale", "6-point Likert scale", "Visual analogue scales"), 
  stringsAsFactors = FALSE
)


table_apa <- table |> 
  gt() |>
  cols_align(align = c("right"), columns = "Scoring") |> 
  cols_label(Number_of_Dimensions = "Number of Dimensions", Number_of_Items = "Number of Items")  |>
  # tab_footnote("* Information taken from the sample description of relevant paper rather than recomputed.") 
  tab_style( style = list(cell_text(weight = "bold")), locations = cells_body(columns = Questionnaire, rows = Questionnaire %in% c("Interoceptive Related", "Mood", "Personality", "Psychopathology", "Beliefs and Misbeliefs")))
  
gt_apastyle(table_apa, font.size=12)
gtsave(gt_apastyle(table_apa, font.size=9), "figures/table2.tex")
```



## Data Preparation

```{r}
#| warning: false

load("../data/data.RData")
load("../data/scores.RData")


df1a <- cbind(data$df1a, scores$sample1a)
df1b <- cbind(data$df1b, scores$sample1b)
df2 <- cbind(data$df2, scores$sample2)
df3 <- cbind(data$df3, scores$sample3)
df4 <- cbind(data$df4, scores$sample4)
df5 <- cbind(data$df5, scores$sample5)
df6 <- cbind(data$df6, scores$sample6)
df7a <- cbind(data$df7a, scores$sample7a)
df7b <- cbind(data$df7b, scores$sample7b)
df7c <- cbind(data$df7c, scores$sample7c)
df8a <- cbind(data$df8a, scores$sample8a)
df8b <- cbind(data$df8b, scores$sample8b)
df9 <- cbind(data$df9, scores$sample9)
df10a <- cbind(data$df10a, scores$sample10a)
df10b <- cbind(data$df10b, scores$sample10b)
df10c <- cbind(data$df10c, scores$sample10c)
df11a <- cbind(data$df11a, scores$sample11a)
df11b <- cbind(data$df11b, scores$sample11b)

vars_intero <- names(select(scores$sample1a, -Sample, -starts_with("CFA_"), -starts_with("EGA")))
# vars_cfa <- names(select(scores$sample1a, -Sample, -starts_with("EGA")))
# vars_intero <- vars_cfa[vars_cfa != "CoughSneeze"]

# names(df1a)
# names(df1b)
# names(df2)  # BPQ, BVAQ, MAIA, ICQ (?), TAS
# names(df3)  # TAS, BPQ
# names(df4)  # BAQ (?), BPQ, MAIA, BRS (resilience?), PBCS (private bodily consciousness?)
# names(df5)  
# names(df6)  # IATS, SSS, GAD, PHQ2
# names(df7a)  # MAIA, STAI, FFMQ, NEOFFI, CES
# names(df7b)  # MAIA, STAI, BPQ, PHQ15, PHQ9
# names(df7c)  # TAS, BPQ, TAS, ASI, BDI, IASV
# names(df8a)  # EDI, BPQ
# names(df8b)  # TAS, PHQ15, PHQ9
# names(df9)  # BFI, STQ, EQ, ECR, 
# names(df10a)  # MAIA, PHQ4, PI, LIE, IPIP, PID, SPQ
# names(df10b)  # BDI, STAI, PHQ4
# names(df10c) # PI, MAIA
# names(df11a) # MAIA, TAS, MFQ(DEP), STAI(ANX)
# names(df11b) 
```

## Empirical Scores vs. Model-based

```{r}
#| warning: false

vars_scores <- names(select(scores$sample1a, -Sample))
df_scores <- rbind(
  select(df1a, all_of(vars_scores)),
  select(df1b, all_of(vars_scores)),
  select(df2, all_of(vars_scores)),
  select(df3, all_of(vars_scores)),
  select(df4, all_of(vars_scores)),
  select(df5, all_of(vars_scores)),
  select(df6, all_of(vars_scores)),
  select(df7a, all_of(vars_scores)),
  select(df7b, all_of(vars_scores)),
  select(df7c, all_of(vars_scores)),
  select(df8a, all_of(vars_scores)),
  select(df8b, all_of(vars_scores)),
  select(df9, all_of(vars_scores)),
  select(df10a, all_of(vars_scores)),
  select(df10b, all_of(vars_scores)),
  select(df10c, all_of(vars_scores)),
  select(df11a, all_of(vars_scores)),
  select(df11b, all_of(vars_scores))
)

order <- c("WindBurp", "CoughSneeze", "MusclesPain", "ItchBruise", "HeartBreathing", "HungryThirsty", "UrinateDefecate")

correlation::correlation(select(df_scores, -all_of(vars_intero)),
                         select(df_scores, all_of(vars_intero))) |> 
  mutate(val = paste0(insight::format_value(r), format_p(p, stars_only = TRUE))) |>
    mutate(Parameter2 = fct_relevel(Parameter2, rev(order)),
           Parameter1 = fct_relevel(Parameter1, paste0("CFA_", order), "EGA3", "EGA2", "EGA4", "EGA1")) |>
    ggplot(aes(x = Parameter1, y = Parameter2)) +
    geom_tile(aes(fill = r), color = "white") +
    geom_text(aes(label = val), size = 3) +
    labs(title = "Correlation Matrix") +
    scale_fill_gradient(low="blue", high="red", limit = c(0.1, 1), guide = guide_colourbar(ticks = FALSE)) +
    theme_minimal() +
    theme(
      legend.title = element_blank(),
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      axis.text.x = element_text(angle = 45, hjust = 1)
    )
```

Even EGA components capture pairs or groupings of pairs of items.

## Demographics

### Gender

```{r}
make_diff <- function(df, vars, component=NA) {
  df <- select(df, all_of(c("Gender", "Sample", vars)))
  df <- df[complete.cases(df), ]
  dat <- data.frame()
  for (resp in vars) {
    f <- as.formula(paste0(resp, "~ Gender"))
    d <- filter(df, Gender %in% c("Male", "Female")) |>
      mutate(Gender = fct_relevel(Gender, "Male", "Female"))
    dat <- effectsize::cohens_d(f, data=d) |>
      as.data.frame() |>
      mutate(var_Correlate = "Gender", 
             var_Interoception = resp,
             p=t.test(f, data=d)$p.val) |>
      rbind(dat)
  }

  dat$r <- effectsize::d_to_r(dat$Cohens_d, n1=sum(df$Gender=="Male"), n2=sum(df$Gender=="Female"))
  dat$CI_low <- effectsize::d_to_r(dat$CI_low, n1=sum(df$Gender=="Male"), n2=sum(df$Gender=="Female"))
  dat$CI_high <- effectsize::d_to_r(dat$CI_high, n1=sum(df$Gender=="Male"), n2=sum(df$Gender=="Female"))
  dat$Sample <- unique(df$Sample)
  dat$Component <- component
  select(dat, -Cohens_d)
}

data <- rbind(
  make_diff(df1a, vars_intero, component="Demographic"),
  make_diff(df1b, vars_intero, component="Demographic"),
  make_diff(df2, vars_intero, component="Demographic"),
  make_diff(df3, vars_intero, component="Demographic"),
  #make_diff(df4, vars_intero, component="Demographic"),
  #make_diff(df5_attention, vars_intero, component="Demographic"),
  make_diff(df6, vars_intero, component="Demographic"),
  make_diff(df7a, vars_intero, component="Demographic"),
  make_diff(df7b, vars_intero, component="Demographic"),
  make_diff(df7c, vars_intero, component="Demographic"),
  make_diff(df8a, vars_intero, component="Demographic"),
  make_diff(df8b, vars_intero, component="Demographic"),
  make_diff(df9, vars_intero, component="Demographic"),
  make_diff(df10a, vars_intero, component="Demographic"),
  make_diff(df10b, vars_intero, component="Demographic"),
  make_diff(df10c, vars_intero, component="Demographic"),
  make_diff(df11a, vars_intero, component="Demographic"),
  make_diff(df11b, vars_intero, component="Demographic")
) |>
  mutate(var_Correlate = "Gender (Male vs. Female)")
```

### Age

```{r}
make_cor <- function(df, vars, with = "Age", component=NA) {
  df <- select(df, all_of(c(with, "Sample", vars)))
  df <- df[complete.cases(df), ]
  
  dat <- data.frame()
  for (v in vars) {
    dat <- correlation::cor_test(df, v, with) |>
      rename(var_Interoception = Parameter1, var_Correlate = Parameter2) |>
      as.data.frame() |>
      rbind(dat)
  }

  dat$Sample <- unique(df$Sample)
  dat$Component <- component
  select(dat, -df_error, -t, -Method, -n_Obs)
}

data <- rbind(
  data,
  make_cor(df1a, vars_intero, with = "Age", component="Demographic"),
  make_cor(df1b, vars_intero, with = "Age", component="Demographic"),
  make_cor(df2, vars_intero, with = "Age", component="Demographic"),
  make_cor(df3, vars_intero, with = "Age", component="Demographic"),
  # make_cor(df4, vars_intero, with = "Age", component="Demographic"),
  # make_cor(df5, vars_intero, with = "Age", component="Demographic"),
  make_cor(df6, vars_intero, with = "Age", component="Demographic"),
  make_cor(df7a, vars_intero, with = "Age", component="Demographic"),
  make_cor(df7b, vars_intero, with = "Age", component="Demographic"),
  make_cor(df7c, vars_intero, with = "Age", component="Demographic"),
  make_cor(df8a, vars_intero, with = "Age", component="Demographic"),
  make_cor(df8b, vars_intero, with = "Age", component="Demographic"),
  make_cor(df9, vars_intero, with = "Age", component="Demographic"),
  make_cor(df10a, vars_intero, with = "Age", component="Demographic"),
  make_cor(df10b, vars_intero, with = "Age", component="Demographic"),
  make_cor(df10c, vars_intero, with = "Age", component="Demographic"),
  make_cor(df11a, vars_intero, with = "Age", component="Demographic"),
  make_cor(df11b, vars_intero, with = "Age", component="Demographic")
)
```



## Body

### MAIA

```{r}
names(df2)[str_detect(names(df2), "MAIA")]  
names(df4)[str_detect(names(df4), "MAIA")]  # ?
names(df7a)[str_detect(names(df7a), "MAIA")]  
names(df7b)[str_detect(names(df7b), "maia")] 
names(df10a)[str_detect(names(df10b), "MAIA")]
names(df10c)[str_detect(names(df10c), "MAIA")]
names(df11a)[str_detect(names(df11b), "MAIA")]


data <- rbind(
  data,
  make_cor(df2, vars_intero, with = "MAIA_AttentionReg", component="MAIA")  |>
    mutate(var_Correlate = "Attention Regulation"),
  make_cor(df2, vars_intero, with = "MAIA_BodyListening", component="MAIA") |>
    mutate(var_Correlate = "Listening"),
  make_cor(df2, vars_intero, with = "MAIA_BodyTrusting", component="MAIA") |>
    mutate(var_Correlate = "Trusting"),
  make_cor(df2, vars_intero, with = "MAIA_EmoAwareness", component="MAIA") |>
    mutate(var_Correlate = "Emotional Awareness"),
  make_cor(df2, vars_intero, with = "MAIA_NotDistracting", component="MAIA") |>
    mutate(var_Correlate = "Not Distracting"),
  make_cor(df2, vars_intero, with = "MAIA_Noticing", component="MAIA") |>
    mutate(var_Correlate = "Noticing"),
  make_cor(df2, vars_intero, with = "MAIA_NotWorrying", component="MAIA") |>
    mutate(var_Correlate = "Not Worrying"),
  make_cor(df2, vars_intero, with = "MAIA_SelfReg", component="MAIA") |>
    mutate(var_Correlate = "Self Regulation"),
  # df4
  # df7a
  make_cor(df7a, vars_intero, with = "mAIA_ATTENTION_REGULATION", component="MAIA") |>
    mutate(var_Correlate = "Attention Regulation"),
  make_cor(df7a, vars_intero, with = "MAIA_NOTICING", component="MAIA") |>
    mutate(var_Correlate = "Noticing"),
  make_cor(df7a, vars_intero, with = "MAIA_NON_DISTRACTING", component="MAIA") |>
    mutate(var_Correlate = "Not Distracting"),
  make_cor(df7a, vars_intero, with = "MAIA_NON_DISTRACTING", component="MAIA") |>
    mutate(var_Correlate = "Not Distracting"),
  make_cor(df7a, vars_intero, with = "MAIA_NOT_WORRYING", component="MAIA") |>
    mutate(var_Correlate = "Not Worrying"),
  make_cor(df7a, vars_intero, with = "MAIA_EMOTIONAL_AWARENESS", component="MAIA") |>
    mutate(var_Correlate = "Emotional Awareness"),
  make_cor(df7a, vars_intero, with = "MAIA_SELF_REGULATION", component="MAIA") |>
    mutate(var_Correlate = "Self Regulation"),
  make_cor(df7a, vars_intero, with = "MAIA_BODY_LISTENING", component="MAIA") |>
    mutate(var_Correlate = "Listening"),
  make_cor(df7a, vars_intero, with = "MAIA_TRUSTING", component="MAIA") |>
    mutate(var_Correlate = "Trusting"),
  
  # df7b
  make_cor(df7b, vars_intero, with = "maiaNotice", component="MAIA") |>
    mutate(var_Correlate = "Noticing"),
  make_cor(df7b, vars_intero, with = "maiaNonDistracting", component="MAIA") |>
    mutate(var_Correlate = "Not Distracting"),
  make_cor(df7b, vars_intero, with = "maiaNotWorrying", component="MAIA") |>
    mutate(var_Correlate = "Not Worrying"),
  make_cor(df7b, vars_intero, with = "maiaAttentionRegulation", component="MAIA") |>
    mutate(var_Correlate = "Attention Regulation"),
  make_cor(df7b, vars_intero, with = "maiaEmotionalAwareness", component="MAIA") |>
    mutate(var_Correlate = "Emotional Awareness"),
  make_cor(df7b, vars_intero, with = "maiaSelfRegulation", component="MAIA") |>
    mutate(var_Correlate = "Self Regulation"),
  make_cor(df7b, vars_intero, with = "maiaBodyListening", component="MAIA") |>
    mutate(var_Correlate = "Listening"),
  make_cor(df7b, vars_intero, with = "maiaTrusting", component="MAIA") |>
    mutate(var_Correlate = "Trusting"),
  
  # df10a
  make_cor(df10a, vars_intero, with = "MAIA_AttentionRegulation", component="MAIA")  |>
    mutate(var_Correlate = "Attention Regulation"),
  make_cor(df10a, vars_intero, with = "MAIA_BodyListening", component="MAIA") |>
    mutate(var_Correlate = "Listening"),
  make_cor(df10a, vars_intero, with = "MAIA_EmotionalAwareness", component="MAIA") |>
    mutate(var_Correlate = "Emotional Awareness"),
  make_cor(df10a, vars_intero, with = "MAIA_NotDistracting", component="MAIA") |>
    mutate(var_Correlate = "Not Distracting"),
  make_cor(df10a, vars_intero, with = "MAIA_Noticing", component="MAIA") |>
    mutate(var_Correlate = "Noticing"),
  make_cor(df10a, vars_intero, with = "MAIA_NotWorrying", component="MAIA") |>
    mutate(var_Correlate = "Not Worrying"),
  make_cor(df10a, vars_intero, with = "MAIA_SelfRegulation", component="MAIA") |>
    mutate(var_Correlate = "Self Regulation"),
  make_cor(df10a, vars_intero, with = "MAIA_Trusting", component="MAIA") |>
    mutate(var_Correlate = "Trusting"),

  # df10c 
  make_cor(df10c, vars_intero, with = "MAIA_AttentionRegulation", component="MAIA")  |>
    mutate(var_Correlate = "Attention Regulation"),
  make_cor(df10c, vars_intero, with = "MAIA_BodyListening", component="MAIA") |>
    mutate(var_Correlate = "Listening"),
  make_cor(df10c, vars_intero, with = "MAIA_EmotionalAwareness", component="MAIA") |>
    mutate(var_Correlate = "Emotional Awareness"),
  make_cor(df10c, vars_intero, with = "MAIA_NotDistracting", component="MAIA") |>
    mutate(var_Correlate = "Not Distracting"),
  make_cor(df10c, vars_intero, with = "MAIA_Noticing", component="MAIA") |>
    mutate(var_Correlate = "Noticing"),
  make_cor(df10c, vars_intero, with = "MAIA_NotWorrying", component="MAIA") |>
    mutate(var_Correlate = "Not Worrying"),
  make_cor(df10c, vars_intero, with = "MAIA_SelfRegulation", component="MAIA") |>
    mutate(var_Correlate = "Self Regulation"),
  make_cor(df10c, vars_intero, with = "MAIA_Trusting", component="MAIA") |>
    mutate(var_Correlate = "Trusting"),


    # df11a
  make_cor(df11a, vars_intero, with = "MAIA_Attention", component="MAIA")  |>
    mutate(var_Correlate = "Attention Regulation"),
  make_cor(df11a, vars_intero, with = "MAIA_BodyListening", component="MAIA") |>
    mutate(var_Correlate = "Listening"),
  make_cor(df11a, vars_intero, with = "MAIA_Emotional", component="MAIA") |>
    mutate(var_Correlate = "Emotional Awareness"),
  make_cor(df11a, vars_intero, with = "MAIA_NotDistracting", component="MAIA") |>
    mutate(var_Correlate = "Not Distracting"),
  make_cor(df11a, vars_intero, with = "MAIA_Noticing", component="MAIA") |>
    mutate(var_Correlate = "Noticing"),
  make_cor(df11a, vars_intero, with = "MAIA_NotWorrying", component="MAIA") |>
    mutate(var_Correlate = "Not Worrying"),
  make_cor(df11a, vars_intero, with = "MAIA_SelfRegulation", component="MAIA") |>
    mutate(var_Correlate = "Self Regulation"),
  make_cor(df11a, vars_intero, with = "MAIA_Trusting", component="MAIA") |>
    mutate(var_Correlate = "Trusting")
)
```


### BPQ

```{r}
# df3$BPQ_BodyAwareness <- -1*normalize(df3$BPQ_BodyAwareness)
# df3$BPQ_AutonomicReactivity <- -1*normalize(df3$BPQ_AutonomicReactivity)
names(df2)[str_detect(names(df2), "BPQ")]  # BPQ_R_Supra and _Sub?
names(df3)[str_detect(names(df3), "BPQ")]  
names(df4)[str_detect(names(df4), "BPQ")]   # individual items 1-26
names(df7b)[str_detect(names(df7b), "BPQ")]  # BPQ sum
names(df8a)[str_detect(names(df8a), "BPQ")]  # individual items


data <- rbind(
  data,
  make_cor(df2, vars_intero, with = "BPQ_A", component="BPQ") |>
    mutate(var_Correlate = "Body Awareness (BPQ)"),
  make_cor(df2, vars_intero, with = "BPQ_R", component="BPQ") |>
    mutate(var_Correlate = "Autonomic Reactivity (BPQ)"),
  make_cor(df3, vars_intero, with = "BPQ_BodyAwareness", component="BPQ") |>
    mutate(var_Correlate = "Body Awareness (BPQ)"),
  make_cor(df3, vars_intero, with = "BPQ_AutonomicReactivity", component="BPQ") |>
    mutate(var_Correlate = "Autonomic Reactivity (BPQ)")
)
```

### Alexithymia

```{r}
names(df2)[str_detect(names(df2), "TAS")]
names(df3)[str_starts(names(df3), "TAS")]
names(df7c)[str_starts(names(df7c), "TAS")]
names(df8b)[str_starts(names(df8b), "TAS")]
names(df11a)[str_starts(names(df11a), "TAS")] 

data <- rbind(
  data,
  make_cor(df2, vars_intero, with = "TAS_DIF", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Identifying Feelings (TAS)"),
  make_cor(df2, vars_intero, with = "TAS_DDF", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Describing Feelings (TAS)"),
  make_cor(df2, vars_intero, with = "TAS_EOT", component="Alexithymia") |>
    mutate(var_Correlate = "External Thinking (TAS)"),
  make_cor(df3, vars_intero, with = "TAS_DescribingFeelings", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Describing Feelings (TAS)"),
  make_cor(df3, vars_intero, with = "TAS_IdentifyingFeelings", component="Alexithymia") |> 
    mutate(var_Correlate = "Difficulties Identifying Feelings (TAS)"),
  make_cor(df3, vars_intero, with = "TAS_ExternallyOrientedThinking", component="Alexithymia") |>
    mutate(var_Correlate = "External Thinking (TAS)"),
  make_cor(df7c, vars_intero, with = "TAS_des", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Describing Feelings (TAS)"),
  make_cor(df7c, vars_intero, with = "TAS_ident", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Identifying Feelings (TAS)"),
  make_cor(df7c, vars_intero, with = "TAS_ext", component="Alexithymia") |>
    mutate(var_Correlate = "External Thinking (TAS)"),
  make_cor(df8b, vars_intero, with = "TAS_DIF", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Identifying Feelings (TAS)"),
  make_cor(df8b, vars_intero, with = "TAS_DDF", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Describing Feelings (TAS)"),
  make_cor(df11a, vars_intero, with = "TAS_DIF", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Identifying Feelings (TAS)"),
  make_cor(df11a, vars_intero, with = "TAS_DDF", component="Alexithymia") |>
    mutate(var_Correlate = "Difficulties Describing Feelings (TAS)"),
  make_cor(df11a, vars_intero, with = "TAS_EOT", component="Alexithymia") |>
    mutate(var_Correlate = "External Thinking (TAS)"),
  # BVAQ
  make_cor(df2, vars_intero, with = "BVAQ_Affective", component="Alexithymia") |>
    mutate(var_Correlate = "Affective (BVAQ)"),
  make_cor(df2, vars_intero, with = "BVAQ_Cognitive", component="Alexithymia") |>
    mutate(var_Correlate = "Cognitive (BVAQ)")
)
```


## Mood

### Depression

```{r}
names(df6)[str_detect(names(df6), "PHQ")] 
names(df7b)[str_detect(names(df7b), "PHQ")]
names(df7c)[str_detect(names(df7c), "BDI")]
names(df8b)[str_detect(names(df8b), "PHQ")]
names(df9)
names(df11a)

data <- rbind(
  data,
  make_cor(df6, vars_intero, with = "PHQ2_sum", component="Mood") |>
    mutate(var_Correlate = "Depression (PHQ-2)"),
  make_cor(df7b, vars_intero, with = "PHQ15_Sum", component="Mood") |>
    mutate(var_Correlate = "Somatic Concerns (PHQ-15)"),
  make_cor(df7b, vars_intero, with = "PHQ9_Sum", component="Mood")|>
    mutate(var_Correlate = "Depression (PHQ-9)"),
  make_cor(df7c, vars_intero, with = "BDI_sum", component="Mood") |>
    mutate(var_Correlate = "Depression (BDI)"),
  make_cor(df8b, vars_intero, with = "PHQ15_sum", component="Mood") |>
    mutate(var_Correlate = "Somatic Concerns (PHQ-15)"),
  make_cor(df8b, vars_intero, with = "PHQ9_sum", component="Mood") |>
    mutate(var_Correlate = "Depression (PHQ-9)"),
  make_cor(df10a, vars_intero, with = "PHQ4_Depression", component="Mood") |>
    mutate(var_Correlate = "Depression (PHQ-2)"),
  make_cor(df10b, vars_intero, with = "BDI2_Total", component="Mood") |>
    mutate(var_Correlate = "Depression (BDI)"),
  make_cor(df11a, vars_intero, with = "DEP", component = "Mood") |>
    mutate(var_Correlate = "Depression (MFQ)")
)
```

### Anxiety

```{r}
names(df6)[str_detect(names(df6), "GAD")] 
names(df7a)[str_detect(names(df7a), "STAI")] 
names(df7b)[str_detect(names(df7b), "STAI")] 
names(df7c)[str_detect(names(df7c), "STAI")]

data <- rbind(
  data,
  make_cor(df6, vars_intero, with = "GAD2_sum", component="Mood") |>
    mutate(var_Correlate = "Anxiety (GAD-2)"),
  make_cor(df7a, vars_intero, with = "STAI_T_Sumscore", component="Mood") |>
    mutate(var_Correlate = "Anxiety (STAI)"),
  make_cor(df7b, vars_intero, with = "STAIT_Sum", component="Mood") |>
    mutate(var_Correlate = "Anxiety (STAI)"),
  make_cor(df7c, vars_intero, with = "STAIT_sum", component="Mood") |>
    mutate(var_Correlate = "Anxiety (STAI)"),
  make_cor(df10a, vars_intero, with = "PHQ4_Anxiety", component="Mood") |>
    mutate(var_Correlate = "Anxiety (GAD-2)"),
  make_cor(df10b, vars_intero, with = "PHQ4_Anxiety", component="Mood") |>
    mutate(var_Correlate = "Anxiety (GAD-2)"),
  make_cor(df10b, vars_intero, with = "STAI5_General", component="Mood") |>
    mutate(var_Correlate = "Anxiety (STAI)"),
  make_cor(df11a, vars_intero, with =  "ANX", component = "Mood") |>
    mutate(var_Correlate = "Anxiety (STAI)")
)
```



## Psychopathology


```{r}
data <- rbind(
  data,
  make_cor(df10a, vars_intero, with = "BPD", component="Mood") |>
    mutate(var_Correlate = "Boderline Personality")
)
```


```{r}
data <- rbind(
  data,
  make_cor(df10a, vars_intero, with = "PID5_Antagonism", component="Maladaptive") |>
    mutate(var_Correlate = "Antagonism"),
  make_cor(df10a, vars_intero, with = "PID5_Detachment", component="Maladaptive") |>
    mutate(var_Correlate = "Detachment"),
  make_cor(df10a, vars_intero, with = "PID5_Disinhibition", component="Maladaptive") |>
    mutate(var_Correlate = "Disinhibition"),
  make_cor(df10a, vars_intero, with = "PID5_NegativeAffect", component="Maladaptive") |>
    mutate(var_Correlate = "Negative Affect"),
  make_cor(df10a, vars_intero, with = "PID5_Psychoticism", component="Maladaptive") |>
    mutate(var_Correlate = "Psychoticism")
)
```

```{r}
data <- rbind(
  data,
  make_cor(df10a, vars_intero, with = "SPQ_ConstrictedAffect", component="Schizotypic") |>
    mutate(var_Correlate = "Constricted Affect"),
  make_cor(df10a, vars_intero, with = "SPQ_Eccentric", component="Schizotypic") |>
    mutate(var_Correlate = "Eccentric"),
  make_cor(df10a, vars_intero, with = "SPQ_MagicalThinking", component="Schizotypic") |>
    mutate(var_Correlate = "Magical Thinking"),
  make_cor(df10a, vars_intero, with = "SPQ_NoCloseFriends", component="Schizotypic") |>
    mutate(var_Correlate = "No Close Friends"),
  make_cor(df10a, vars_intero, with = "SPQ_OddSpeech", component="Schizotypic") |>
    mutate(var_Correlate = "Odd Speech"),
  make_cor(df10a, vars_intero, with = "SPQ_Reference", component="Schizotypic") |>
    mutate(var_Correlate = "Reference"),
  make_cor(df10a, vars_intero, with = "SPQ_SocialAnxiety", component="Schizotypic") |>
    mutate(var_Correlate = "Social Anxiety"),
  make_cor(df10a, vars_intero, with = "SPQ_Suspiciousness", component="Schizotypic") |>
    mutate(var_Correlate = "Suspiciousness"),
  make_cor(df10a, vars_intero, with = "SPQ_UnusualPerceptions", component="Schizotypic") |>
    mutate(var_Correlate = "Unusual Perceptions")
)
```


```{r}
#  names(select(df10a, starts_with("ASQ")))
data <- rbind(
  data,
  make_cor(df10a, vars_intero, with = "ASQ_Imagination", component="Autistic") |>
    mutate(var_Correlate = "Imagination"),
  make_cor(df10a, vars_intero, with = "ASQ_LackSocialSkills", component="Autistic") |>
    mutate(var_Correlate = "Lack of Social Skills"),
  make_cor(df10a, vars_intero, with = "ASQ_LowAttentionalSwitching", component="Autistic") |>
    mutate(var_Correlate = "Low Attentional Switching"),
  make_cor(df10a, vars_intero, with = "ASQ_Patterns", component="Autistic") |>
    mutate(var_Correlate = "Patterns and Numbers"),
  make_cor(df10a, vars_intero, with = "ASQ_Routine", component="Autistic") |>
    mutate(var_Correlate = "Routines")
)
```


## Personality

```{r}
names(df7a)[str_detect(names(df7a), "NEO")]
names(df9)[str_detect(names(df9), "BFI_")]

data <- rbind(
  data,
  make_cor(df9, vars_intero, with = "BFI_AGREEABLENESS", component="Personality") |>
    mutate(var_Correlate = "Agreeableness"),
  make_cor(df9, vars_intero, with = "BFI_CONSCIENTIOUSNESS", component="Personality") |>
    mutate(var_Correlate = "Conscientiousness"),
  make_cor(df9, vars_intero, with = "BFI_NEUROTICISM", component="Personality") |>
    mutate(var_Correlate = "Neuroticism"),
  make_cor(df9, vars_intero, with = "BFI_OPENNESS", component="Personality") |>
    mutate(var_Correlate = "Openness"),
  make_cor(df9, vars_intero, with = "BFI_EXTROVERSION", component="Personality") |>
    mutate(var_Correlate = "Extraversion"),
  make_cor(df10a, vars_intero, with = "IPIP6_Agreeableness", component="Personality") |>
    mutate(var_Correlate = "Agreeableness"),
  make_cor(df10a, vars_intero, with = "IPIP6_Conscientiousness", component="Personality") |>
    mutate(var_Correlate = "Conscientiousness"),
  make_cor(df10a, vars_intero, with = "IPIP6_Neuroticism", component="Personality") |>
    mutate(var_Correlate = "Neuroticism"),
  make_cor(df10a, vars_intero, with = "IPIP6_Openness", component="Personality") |>
    mutate(var_Correlate = "Openness"),
  make_cor(df10a, vars_intero, with = "IPIP6_Extraversion", component="Personality") |>
    mutate(var_Correlate = "Extraversion"),
  make_cor(df10a, vars_intero, with = "IPIP6_HonestyHumility", component="Personality") |>
    mutate(var_Correlate = "Honesty-Humility")
)
```

## Others


```{r}
data <- rbind(
  data,
  make_cor(df10a, vars_intero, with = "PI_Alive", component="World Beliefs") |>
    mutate(var_Correlate = "Alive"),
  make_cor(df10a, vars_intero, with = "PI_Changing", component="World Beliefs") |>
    mutate(var_Correlate = "Changing"),
  make_cor(df10a, vars_intero, with = "PI_Enticing", component="World Beliefs") |>
    mutate(var_Correlate = "Enticing"),
  make_cor(df10a, vars_intero, with = "PI_Good", component="World Beliefs") |>
    mutate(var_Correlate = "Good"),
  make_cor(df10a, vars_intero, with = "PI_Hierarchical", component="World Beliefs") |>
    mutate(var_Correlate = "Hierarchical"),
  make_cor(df10a, vars_intero, with = "PI_Safe", component="World Beliefs") |>
    mutate(var_Correlate = "Safe"),
  make_cor(df10a, vars_intero, with = "PI_Understandable", component="World Beliefs") |>
    mutate(var_Correlate = "Understandable"),
  make_cor(df10c, vars_intero, with = "PI_Alive", component="World Beliefs") |>
    mutate(var_Correlate = "Alive"),
  make_cor(df10c, vars_intero, with = "PI_Changing", component="World Beliefs") |>
    mutate(var_Correlate = "Changing"),
  make_cor(df10c, vars_intero, with = "PI_Enticing", component="World Beliefs") |>
    mutate(var_Correlate = "Enticing"),
  make_cor(df10c, vars_intero, with = "PI_Good", component="World Beliefs") |>
    mutate(var_Correlate = "Good"),
  make_cor(df10c, vars_intero, with = "PI_Hierarchical", component="World Beliefs") |>
    mutate(var_Correlate = "Hierarchical"),
  make_cor(df10c, vars_intero, with = "PI_Safe", component="World Beliefs") |>
    mutate(var_Correlate = "Safe"),
  make_cor(df10c, vars_intero, with = "PI_Understandable", component="World Beliefs") |>
    mutate(var_Correlate = "Understandable")
)
```

```{r}
data <- rbind(
  data,
  make_cor(df10a, vars_intero, with = "GCBS_Extraterrestrial", component="Conspiracy Beliefs") |>
    mutate(var_Correlate = "Extraterrestrial"),
  make_cor(df10a, vars_intero, with = "GCBS_GlobalConspiracies", component="Conspiracy Beliefs") |>
    mutate(var_Correlate = "Global Conspiracies"),
  make_cor(df10a, vars_intero, with = "GCBS_GovernmentMalfeasance", component="Conspiracy Beliefs") |>
    mutate(var_Correlate = "Government Malfeasance"),
  make_cor(df10a, vars_intero, with = "GCBS_InformationControl", component="Conspiracy Beliefs") |>
    mutate(var_Correlate = "Information Control"),
  make_cor(df10a, vars_intero, with = "GCBS_PersonalWellbeing", component="Conspiracy Beliefs") |>
    mutate(var_Correlate = "Personal Wellbeing")
)
```

```{r}
data <- rbind(
  data,
  make_cor(df10a, vars_intero, with = "LIE_Ability", component="Lying Profile") |>
    mutate(var_Correlate = "Ability"),
  make_cor(df10a, vars_intero, with = "LIE_Frequency", component="Lying Profile") |>
    mutate(var_Correlate = "Frequency"),
  make_cor(df10a, vars_intero, with = "LIE_Contextuality", component="Lying Profile") |>
    mutate(var_Correlate = "Contextuality"),
  make_cor(df10a, vars_intero, with = "LIE_Negativity", component="Lying Profile") |>
    mutate(var_Correlate = "Negativity")
)
```

## Average Correlations

- BPQ - sf - Body perception questionnaire short form
- BPQ - vsf - Body perception questionnaire very short form 
- BVAQ - Bermond–Vorst Alexithymia Questionnaire 
- MAIA-2 - Multidimensional Assessment of Interoceptive Awareness , Version-2
- ICQ  - Interocpetive Confusion Questionnaire
- TAS - Toronto Alexithymia Scale 
- BAQ - Body awareness questionnaire
- BRS - the body responsiveness scale 
- PHQ-2 - Patient Health Questionnaire 2 items on major depressive episodes 
- PHQ-4 - atient Health Questionnaire 4 items assessing anxiety and depression 
- PHQ-9 - Patient Health Questionnaire 9-Item Version assesses depressive symptoms
- PHQ-15 - Patient Health Questionnaire 15-Item Version assesses Somatic symptom distress 
- SSS-8 - Somatic Symptom Scale 
- IATS - Interoceptive Attention Scale
- GAD-2 - Generalized Anxiety Disorder Scale 2 items on anxiety disorder 
- STAIT - State-Trait-Anxiety Inventory Trait subscale
- FFMQ - Observation and Description subscales of the Five Facet Mindfulness Questionnaire
- NEOFFI - Neuroticism Neo Five-Factor Inventory Neuroticism subscale
- ASI - Anxiety Sensitivity Inventory 3
- BDI - The Beck Depression Inventory
- EDI_IA - Eating Disorder Inventory, interoceptive awareness subscale
- BFI -  Big Five inventory-10
- ASQ -  Autism-Spectrum Quotient
- MSI-BPD - Mclean Screening Instrument for Borderline Personality Disorder
- GCB - Generic Conspiracist Beliefs scale
- IPIP6 - Mini International Personality Item Pool
- PI - Primal Inventory 18 items and 99 items 
- PID5-sf - Personality Inventory for DSM-5 Short Form 
- SPQ-BRU - Schizotypal Personality Questionnaire, brief revised updated
- LIE - Lying Profile Questionnaire


## Summary

```{r}
#| fig-height: 20
#| fig-width: 15

p <- data |>
  mutate(sig = ifelse(p < .01, "p < .01", ifelse(p < .001, "p < .001", "N.S.")),
         dir = sign(r),
         var_Interoception = str_replace(var_Interoception, "CoughSneeze", "Cough/Sneeze"),
         var_Interoception = str_replace(var_Interoception, "HeartBreathing", "Heart/Breathing"),
         var_Interoception = str_replace(var_Interoception, "HungryThirsty", "Hungry/Thirsty"),
         var_Interoception = str_replace(var_Interoception, "ItchBruise", "Itch/Bruise"),
         var_Interoception = str_replace(var_Interoception, "MusclesPain", "Muscles/Pain"),
         var_Interoception = str_replace(var_Interoception, "UrinateDefecate", "Urinate/Defecate"),
         var_Interoception = str_replace(var_Interoception, "WindBurp", "Wind/Burp"),
         var_Interoception = str_replace(var_Interoception, "Expulsion_Sudden", "Expulsion - Sudden"),
         var_Interoception = fct_relevel(var_Interoception, "Heart/Breathing", "Muscles/Pain", "Itch/Bruise", "Hungry/Thirsty", "Urinate/Defecate", "Wind/Burp", "Cough/Sneeze")) |>
         # Component = fct_relevel(
         #   Component, "Demographic", "MAIA", "Body", "Mood", "Maladaptive",
         #   "Schizotypic", "Autistic", "Personality", "Conspiracy Beliefs", "World Beliefs", "Lying Profile")) |>
  ggplot(aes(x = var_Correlate)) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  # geom_bar(aes(fill=Sample, alpha=sig, y=r, group=Sample), stat="identity", position = position_dodge2(width = 0.8)) +
  geom_linerange(aes(color=dir, alpha=sig, ymin=0, ymax=r, group=Sample), position = position_dodge2(width = 0.7), linewidth=2.5) +
  geom_linerange(aes(ymin = CI_low, ymax = CI_high, color = dir, alpha=sig, group=Sample), position = position_dodge2(width = 0.7)) +
  scale_fill_gradient(low = "#2196F3", high = "#FF5722", guide = "none") +
  scale_color_gradient(low = "#2196F3", high = "#FF5722", guide = "none") +
  scale_alpha_discrete(range = c(0.2, 0.7), guide = "none") +
  scale_y_continuous(expand = c(0, 0), breaks = c(-0.3, 0, 0.3)) +
  facet_grid(Component ~ var_Interoception, scales = "free_y", switch = "y") +
  coord_flip(ylim = c(-0.7, 0.7)) +
  theme_modern(axis.title.space = 5) +
  theme(panel.grid.major.y = element_line(),
        axis.title.y = element_blank(),
        axis.line.x = element_blank(),
        axis.text.y = element_text(size = rel(0.5)),
        axis.text.x = element_text(size = rel(0.8)),
        plot.title = element_text(face = "bold", hjust = 0),
        strip.placement = "outside",
        strip.background.y = element_rect(fill = "#E0E0E0", color = "white"),
        strip.background.x = element_rect(fill = "#F8BBD0", color = "white"))
p
ggsave("figures/Figure2.png", p, width=21*0.6, height=29.7*0.45, dpi=200, bg="white")
```


## Discussion


Benefits of the IAS:
- Straightforward and sensation-centered items

Recommendations:
- Remove Itch (redundant + issue in Chinese)
- Use analog scales

Limitations:
- Not much clear theorethical or empirical structure (small grouping of items)
- Limited variability (clear mode at 4/5), very low prevalence of 5/5 responses.
- Ambiguous items which grouping depends on the context (and its awareness)
  - E.g., heart beating fast, vomit when nauseaous
- Few items for some modalities (e.g., 1 for heart)
- Positive phrasing: benefits but also might exacerbate positivity bias (and thus unidimensionality)

Need for context-specific items (cross-modal when possible, i.E., cardioception, respiroception, etc.).


New Scale: Multimodal Interoceptive Sensitivity Scale (MISS)
